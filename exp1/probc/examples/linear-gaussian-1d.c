#include "probabilistic.h"

#define TT 50

static double observations[TT] = { -1.20707157387629, 0.503699165203634, -1.70259337251950, -1.07701410185052, -4.20015625145706, -2.55438990317829, -2.88694661081943, -4.40447415469792, -3.81651098631986, -2.15054191207990, -3.87320140517147, -4.65399867465777, -4.26508970171536, -3.14697618846827, -3.60917468266110, -3.07249239739850, -5.04848080730519, -5.44188426787942, -6.61603453344347, -5.32349283632955, -2.99619527386241, -3.53678845221103, -2.64189362941369, 1.45816318303479, -2.02628921886034, -1.67116883723701, -2.61006571130934, -0.132727439342172, -2.50592100272724, -2.59957628660503, -2.59823005016528, -2.50377973112962, 0.154070601230415, -2.12846084927619, -0.826886102795848, -1.69889462610020, 0.0282576381525715, 1.11518667015325, 2.26764785249174, 0.953894440382874, 0.716919703921550, 2.94790364504733, 1.28843368086306, -0.347295516164936, 0.890889951105044, -0.248679114600237, -0.819067269458265, -0.0280449001139889, -1.02140323226019, -0.392038555131002 };

/**
 *
 * True distribution for this example:
 *
 * mean =
 *   [ -0.603535786938143, 0.0608051843469235, -1.02436315834011, -1.05688285874360, -2.99935518008338, -2.72435518062272, -2.82484201535085, -3.80110809020092, -3.81062760313355, -2.78463822802137, -3.45740726980891, -4.19694142855642, -4.23905937764247, -3.56411484819228, -3.59196335742144, -3.27091264795874, -4.36951018775442, -5.03227381792607, -6.01109177016267, -5.58613225842561, -3.98546317324514, -3.70816694575318, -3.04917379495830, -0.263486343809338, -1.35295843605689, -1.54962327955995, -2.20501274549366, -0.924269991905058, -1.90178407493380, -2.33304337883158, -2.49693775507925, -2.50116632882859, -0.860139657868198, -1.64400526281010, -1.13899784906253, -1.48503308746333, -0.549767984172711, 0.479230581928067, 1.58453324120373, 1.19477702767197, 0.899444959821146, 2.16546205184085, 1.62342870947863, 0.405454155578088, 0.705469976569591, 0.115773407891815, -0.461989904776508, -0.193797142646840, -0.705285835324281, -0.511688369281373 ]
 *
 * variance = 
 *   [ 0.500000000000000, 0.600000000000000, 0.615384615384615, 0.617647058823529, 0.617977528089888, 0.618025751072961, 0.618032786885246, 0.618033813400125, 0.618033963166706, 0.618033985017358, 0.618033988205325, 0.618033988670443, 0.618033988738303, 0.618033988748204, 0.618033988749648, 0.618033988749859, 0.618033988749890, 0.618033988749894, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895, 0.618033988749895 ]
 *
 * p(y_t|y_{t-1}) =
 *   [ 0.195975119409106, 0.197448448890002, 0.136055913892914, 0.246554039769197, 0.0373545899562793, 0.237413033217482, 0.245318571191630, 0.153094738648854, 0.246548725578092, 0.145660389843767, 0.196624502055082, 0.187569517128898, 0.246341296836209, 0.196336468176759, 0.246464298909896, 0.234174869470763, 0.134847787656850, 0.197942603227040, 0.152713349110945, 0.225272240237952, 0.0684794815233197, 0.237260411787453, 0.198436457260026, 0.00509152622304332, 0.136200790930585, 0.241837591264221, 0.198906973323424, 0.108576383456494, 0.152908244058624, 0.224665499498161, 0.243270559475538, 0.246557684498868, 0.0641433648117991, 0.181341551405604, 0.217041521107854, 0.232231502004769, 0.159213252453646, 0.145210715256340, 0.133855108676898, 0.228525995042218, 0.236038376847812, 0.110631546842574, 0.212874938185117, 0.117433699381140, 0.235709514070056, 0.207210233607380, 0.208658657265807, 0.237850242371700, 0.216327741473079, 0.241982384283132 ]
 *
 *
 */

int main(int argc, char **argv) {

    double path[TT] = { 0 };

    double vo = 1;
    double vx = 1;

    for (int t=0; t<TT; t++) {
        path[t] = normal_rng((t==0) ? 0 : path[t-1], vx);
        observe(normal_lnp(observations[t], path[t], vo));
        predict("state[%d],%0.8f\n", t, path[t]);
    }

    return 0;
}
